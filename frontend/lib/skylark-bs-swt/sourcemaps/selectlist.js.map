{"version":3,"sources":["selectlist.js"],"names":["define","langx","browser","eventer","noder","geom","velm","$","sbswt","old","fn","selectlist","Selectlist","WidgetBase","inherit","klassName","init","element","options","this","$element","mixin","defaults","$button","find","$hiddenField","$label","$dropdownMenu","dropdown","on","proxy","itemClicked","setDefaultSelection","resize","attr","items","children","length","disable","doSelect","emptyLabelHTML","$this","document","e","key","String","fromCharCode","which","each","idx","item","text","charAt","toLowerCase","focus","off","destroy","remove","outerHTML","$item","$selectedItem","val","html","is","removeData","removeAttr","trigger","preventDefault","currentTarget","parent","target","itemChanged","closest","data","selectedItem","width","newWidth","sizer","addClass","Boolean","hasClass","body","append","clone","outerWidth","css","txt","selectByText","textContent","innerText","selectByValue","value","selector","selectBySelector","selectByIndex","index","eq","has","enable","removeClass","prototype","getValue","option","methodReturn","args","Array","slice","call","arguments","$set","apply","undefined","Constructor","noConflict"],"mappings":"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","file":"../selectlist.js","sourcesContent":["define([\n  \"skylark-utils/langx\",\n  \"skylark-utils/browser\",\n  \"skylark-utils/eventer\",\n  \"skylark-utils/noder\",\n  \"skylark-utils/geom\",\n  \"skylark-utils/velm\",\n  \"skylark-utils/query\",\n  \"./sbswt\"\n],function(langx,browser,eventer,noder,geom,velm,$,sbswt){\n\n\n\t/*\n\t * Fuel UX Checkbox\n\t * https://github.com/ExactTarget/fuelux\n\t *\n\t * Copyright (c) 2014 ExactTarget\n\t * Licensed under the BSD New license.\n\t */\n\n\tvar old = $.fn.selectlist;\n\t// SELECT CONSTRUCTOR AND PROTOTYPE\n\n\tvar Selectlist = sbswt.Selectlist = sbswt.WidgetBase.inherit({\n\t\tklassName: \"Selectlist\",\n\n\t\tinit : function(element,options) {\n\t\t\tthis.$element = $(element);\n\t\t\tthis.options = langx.mixin({}, $.fn.selectlist.defaults, options);\n\n\n\t\t\tthis.$button = this.$element.find('.btn.dropdown-toggle');\n\t\t\tthis.$hiddenField = this.$element.find('.hidden-field');\n\t\t\tthis.$label = this.$element.find('.selected-label');\n\t\t\tthis.$dropdownMenu = this.$element.find('.dropdown-menu');\n\n\t\t\tthis.$button.dropdown();\n\n\t\t\tthis.$element.on('click.fu.selectlist', '.dropdown-menu a', langx.proxy(this.itemClicked, this));\n\t\t\tthis.setDefaultSelection();\n\n\t\t\tif (options.resize === 'auto' || this.$element.attr('data-resize') === 'auto') {\n\t\t\t\tthis.resize();\n\t\t\t}\n\n\t\t\t// if selectlist is empty or is one item, disable it\n\t\t\tvar items = this.$dropdownMenu.children('li');\n\t\t\tif( items.length === 0) {\n\t\t\t\tthis.disable();\n\t\t\t\tthis.doSelect( $(this.options.emptyLabelHTML));\n\t\t\t}\n\n\t\t\t// support jumping focus to first letter in dropdown when key is pressed\n\t\t\tthis.$element.on('shown.bs.dropdown', function () {\n\t\t\t\t\tvar $this = $(this);\n\t\t\t\t\t// attach key listener when dropdown is shown\n\t\t\t\t\t$(document).on('keypress.fu.selectlist', function(e){\n\n\t\t\t\t\t\t// get the key that was pressed\n\t\t\t\t\t\tvar key = String.fromCharCode(e.which);\n\t\t\t\t\t\t// look the items to find the first item with the first character match and set focus\n\t\t\t\t\t\t$this.find(\"li\").each(function(idx,item){\n\t\t\t\t\t\t\tif ($(item).text().charAt(0).toLowerCase() === key) {\n\t\t\t\t\t\t\t\t$(item).children('a').focus();\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t// unbind key event when dropdown is hidden\n\t\t\tthis.$element.on('hide.bs.dropdown', function () {\n\t\t\t\t\t$(document).off('keypress.fu.selectlist');\n\t\t\t});\n\t\t},\n\n\t\tdestroy: function () {\n\t\t\tthis.$element.remove();\n\t\t\t// any external bindings\n\t\t\t// [none]\n\t\t\t// empty elements to return to original markup\n\t\t\t// [none]\n\t\t\t// returns string of markup\n\t\t\treturn this.$element[0].outerHTML;\n\t\t},\n\n\t\tdoSelect: function ($item) {\n\t\t\tvar $selectedItem;\n\t\t\tthis.$selectedItem = $selectedItem = $item;\n\n\t\t\tthis.$hiddenField.val(this.$selectedItem.attr('data-value'));\n\t\t\tthis.$label.html($(this.$selectedItem.children()[0]).html());\n\n\t\t\t// clear and set selected item to allow declarative init state\n\t\t\t// unlike other controls, selectlist's value is stored internal, not in an input\n\t\t\tthis.$element.find('li').each(function () {\n\t\t\t\tif ($selectedItem.is($(this))) {\n\t\t\t\t\t$(this).attr('data-selected', true);\n\t\t\t\t} else {\n\t\t\t\t\t$(this).removeData('selected').removeAttr('data-selected');\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\titemClicked: function (e) {\n\t\t\tthis.$element.trigger('clicked.fu.selectlist', this.$selectedItem);\n\n\t\t\te.preventDefault();\n\t\t\t// ignore if a disabled item is clicked\n\t\t\tif ($(e.currentTarget).parent('li').is('.disabled, :disabled')) { return; }\n\n\t\t\t// is clicked element different from currently selected element?\n\t\t\tif (!($(e.target).parent().is(this.$selectedItem))) {\n\t\t\t\tthis.itemChanged(e);\n\t\t\t}\n\n\t\t\t// return focus to control after selecting an option\n\t\t\tthis.$element.find('.dropdown-toggle').focus();\n\t\t},\n\n\t\titemChanged: function (e) {\n\t\t\t//selectedItem needs to be <li> since the data is stored there, not in <a>\n\t\t\tthis.doSelect($(e.target).closest('li'));\n\n\t\t\t// pass object including text and any data-attributes\n\t\t\t// to onchange event\n\t\t\tvar data = this.selectedItem();\n\t\t\t// trigger changed event\n\t\t\tthis.$element.trigger('changed.fu.selectlist', data);\n\t\t},\n\n\t\tresize: function () {\n\t\t\tvar width = 0;\n\t\t\tvar newWidth = 0;\n\t\t\tvar sizer = $('<div/>').addClass('selectlist-sizer');\n\n\n\t\t\tif (Boolean($(document).find('html').hasClass('fuelux'))) {\n\t\t\t\t// default behavior for fuel ux setup. means fuelux was a class on the html tag\n\t\t\t\t$(document.body).append(sizer);\n\t\t\t} else {\n\t\t\t\t// fuelux is not a class on the html tag. So we'll look for the first one we find so the correct styles get applied to the sizer\n\t\t\t\t$('.fuelux:first').append(sizer);\n\t\t\t}\n\n\t\t\tsizer.append(this.$element.clone());\n\n\t\t\tthis.$element.find('a').each(function () {\n\t\t\t\tsizer.find('.selected-label').text($(this).text());\n\t\t\t\tnewWidth = sizer.find('.selectlist').outerWidth();\n\t\t\t\tnewWidth = newWidth + sizer.find('.sr-only').outerWidth();\n\t\t\t\tif (newWidth > width) {\n\t\t\t\t\twidth = newWidth;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (width <= 1) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$button.css('width', width);\n\t\t\tthis.$dropdownMenu.css('width', width);\n\n\t\t\tsizer.remove();\n\t\t},\n\n\t\tselectedItem: function () {\n\t\t\tvar txt = this.$selectedItem.text();\n\t\t\treturn langx.mixin({\n\t\t\t\ttext: txt\n\t\t\t}, this.$selectedItem.data());\n\t\t},\n\n\t\tselectByText: function (text) {\n\t\t\tvar $item = $([]);\n\t\t\tthis.$element.find('li').each(function () {\n\t\t\t\tif ((this.textContent || this.innerText || $(this).text() || '').toLowerCase() === (text || '').toLowerCase()) {\n\t\t\t\t\t$item = $(this);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.doSelect($item);\n\t\t},\n\n\t\tselectByValue: function (value) {\n\t\t\tvar selector = 'li[data-value=\"' + value + '\"]';\n\t\t\tthis.selectBySelector(selector);\n\t\t},\n\n\t\tselectByIndex: function (index) {\n\t\t\t// zero-based index\n\t\t\tvar selector = 'li:eq(' + index + ')';\n\t\t\tthis.selectBySelector(selector);\n\t\t},\n\n\t\tselectBySelector: function (selector) {\n\t\t\tvar $item = this.$element.find(selector);\n\t\t\tthis.doSelect($item);\n\t\t},\n\n\t\tsetDefaultSelection: function () {\n\t\t\tvar $item = this.$element.find('li[data-selected=true]').eq(0);\n\n\t\t\tif ($item.length === 0) {\n\t\t\t\t$item = this.$element.find('li').has('a').eq(0);\n\t\t\t}\n\n\t\t\tthis.doSelect($item);\n\t\t},\n\n\t\tenable: function () {\n\t\t\tthis.$element.removeClass('disabled');\n\t\t\tthis.$button.removeClass('disabled');\n\t\t},\n\n\t\tdisable: function () {\n\t\t\tthis.$element.addClass('disabled');\n\t\t\tthis.$button.addClass('disabled');\n\t\t}\n\n\t});\t\n\n\n\tSelectlist.prototype.getValue = Selectlist.prototype.selectedItem;\n\n\n\t// SELECT PLUGIN DEFINITION\n\n\t$.fn.selectlist = function (option) {\n\t\tvar args = Array.prototype.slice.call(arguments, 1);\n\t\tvar methodReturn;\n\n\t\tvar $set = this.each(function () {\n\t\t\tvar $this = $(this);\n\t\t\tvar data = $this.data('fu.selectlist');\n\t\t\tvar options = typeof option === 'object' && option;\n\n\t\t\tif (!data) {\n\t\t\t\t$this.data('fu.selectlist', (data = new Selectlist(this, options)));\n\t\t\t}\n\n\t\t\tif (typeof option === 'string') {\n\t\t\t\tmethodReturn = data[option].apply(data, args);\n\t\t\t}\n\t\t});\n\n\t\treturn (methodReturn === undefined) ? $set : methodReturn;\n\t};\n\n\t$.fn.selectlist.defaults = {\n\t\temptyLabelHTML: '<li data-value=\"\"><a href=\"#\">No items</a></li>'\n\t};\n\n\t$.fn.selectlist.Constructor = Selectlist;\n\n\t$.fn.selectlist.noConflict = function () {\n\t\t$.fn.selectlist = old;\n\t\treturn this;\n\t};\n\n\n\t// DATA-API\n\n\t/*\n\t$(document).on('mousedown.fu.selectlist.data-api', '[data-initialize=selectlist]', function (e) {\n\t\tvar $control = $(e.target).closest('.selectlist');\n\t\tif (!$control.data('fu.selectlist')) {\n\t\t\t$control.selectlist($control.data());\n\t\t}\n\t});\n\n\t// Must be domReady for AMD compatibility\n\t$(function () {\n\t\t$('[data-initialize=selectlist]').each(function () {\n\t\t\tvar $this = $(this);\n\t\t\tif (!$this.data('fu.selectlist')) {\n\t\t\t\t$this.selectlist($this.data());\n\t\t\t}\n\t\t});\n\t});\n\n\t*/\n\n\treturn $.fn.selectlist;\n});\n"]}