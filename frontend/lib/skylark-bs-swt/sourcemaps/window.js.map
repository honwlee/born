{"version":3,"sources":["window.js"],"names":["define","langx","browser","datax","eventer","noder","geom","velm","$","mover","sbswt","namespace","Window","WidgetBase","inherit","klassName","init","element","options","defaults","selectors","handle","title","body","footer","elements","references","window","effect","parseHandleForTitle","maximized","maximizable","bodyContent","footerContent","this","mixin","_this","$el","hasClass","addClass","data","find","length","prepend","html","buttons","maximize","restore","undock","setSticky","sticky","css","appendTo","centerWindow","test","navigator","userAgent","bind","event","on","e","stopPropagation","initHandlers","hide","id","show","removeClass","state","bottomOffset","window_manager","getContainer","height","top","parseInt","left","right","bottom","maxWidth","width","trigger","removeAttr","undefined","window_info","removeProp","cb","callbackHandler","call","arguments","fadeIn","setEffect","getEffect","maxHeight","bodyTop","position","outerWidth","outerHeight","close","parent","clearBlocker","setFocused","windows","setNextFocused","closeFn","remove","fadeOut","$windowTab","apply","sendToBack","returnVal","setActive","active","setIndex","index","setWindowTab","windowTab","getWindowTab","getTitle","getElement","getSticky","setManager","preventDefault","blocker","moveable","movable","resize","setBlocker","window_handle","shade","append","getParent","setParent","getBlocker","blink","focused","blinkInterval","setInterval","toggleClass","setTimeout","clearInterval","elm","wgt","option","fn","each","partial","domNode","off","$this","opts","clone","WindowManager","initialize","findWindowByID","returnValue","console","log","destroyWindow","splice","resortWindows","closeWindow","startZIndex","focused_window","focusedWindowIndex","windowHandle","push","indexOf","unshift","container","addWindow","window_object","scrollTo","createWindow","window_options","final_options","windowTemplate","template","newWindow"],"mappings":"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","file":"../window.js","sourcesContent":["define([\n  \"skylark-utils/langx\",\n  \"skylark-utils/browser\",\n  \"skylark-utils/datax\",\n  \"skylark-utils/eventer\",\n  \"skylark-utils/noder\",\n  \"skylark-utils/geom\",\n  \"skylark-utils/velm\",\n  \"skylark-utils/query\",\n  \"skylark-utils/mover\",\n  \"./sbswt\"\n],function(langx,browser,datax,eventer,noder,geom,velm,$,mover,sbswt){\n\n\n/*----------------------------------------------------------------------*/\n    /*\n    https://github.com/earmbrust/bootstrap-window\n\n    Copyright (c) 2013-2015 Elden Armbrust\n\n    Permission is hereby granted, free of charge, to any person obtaining a copy\n    of this software and associated documentation files (the \"Software\"), to deal\n    in the Software without restriction, including without limitation the rights\n    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n    copies of the Software, and to permit persons to whom the Software is\n    furnished to do so, subject to the following conditions:\n\n    The above copyright notice and this permission notice shall be included in\n    all copies or substantial portions of the Software.\n\n    THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n    THE SOFTWARE.\n    */\n    var namespace = 'bsw';\n\n    var Window = sbswt.Window = sbswt.WidgetBase.inherit({\n        klassName: \"Window\",\n\n        init : function(element,options) {\n            options = options || {};\n            var defaults = {\n                selectors: {\n                    handle: '.window-header',\n                    title: '.window-title',\n                    body: '.window-body',\n                    footer: '.window-footer'\n                },\n                elements: {\n                    handle: null,\n                    title: null,\n                    body: null,\n                    footer: null\n                },\n                references: {\n                    body: $('body'),\n                    window: $(window)\n                },\n                effect: 'fade',\n                parseHandleForTitle: true,\n                maximized: false,\n                maximizable: false,\n                title: 'No Title',\n                bodyContent: '',\n                footerContent: ''\n            };\n            options = this.options = langx.mixin({}, defaults, options,true);\n\n            var _this = this;\n\n            this.$el = $(element);\n\n            if (!this.$el.hasClass('window')) {\n                this.$el.addClass('window');\n            }\n            this.$el.data('window', this);\n\n            if (this.$el.find(options.selectors.handle).length <= 0) {\n                this.$el.prepend('<div class=\"window-header\"><h4 class=\"window-title\"></h4></div>');\n            }\n\n            options.elements.handle = this.$el.find(options.selectors.handle);\n            options.elements.title = this.$el.find(options.selectors.title);\n            options.elements.body = this.$el.find(options.selectors.body);\n            options.elements.footer = this.$el.find(options.selectors.footer);\n            options.elements.title.html(options.title);\n\n            if (options.maximizable) {\n                options.elements.buttons = {};\n                options.elements.buttons.maximize = $('<button data-maximize=\"window\"><i class=\"glyphicon glyphicon-chevron-up\"></i></button>');\n                options.elements.handle.prepend(options.elements.buttons.maximize);\n                options.elements.buttons.restore = $('<button data-restore=\"window\"><i class=\"glyphicon glyphicon-modal-window\"></i></button>');\n                options.elements.handle.prepend(options.elements.buttons.restore);\n\n            }\n            if (_this.$el.find('[data-dismiss=window]').length <= 0) {\n                options.elements.handle.prepend('<button type=\"button\" class=\"close\" data-dismiss=\"window\" aria-hidden=\"true\"><i class=\"glyphicon glyphicon-remove\"></i></button>');\n            }\n            options.elements.body.html(options.bodyContent);\n            options.elements.footer.html(options.footerContent);\n\n            this.undock();\n\n            this.setSticky(options.sticky);\n\n            return this;\n        },\n\n        undock : function() {\n            var _this = this;\n            this.$el.css('visibility', 'hidden');\n            this.$el.appendTo('body');\n            this.centerWindow();\n            if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {\n                this.options.references.window.bind('orientationchange resize', function(event) {\n                    _this.centerWindow();\n                });\n            }\n\n            this.$el.on('touchmove', function(e) {\n                e.stopPropagation();\n            });\n\n            this.initHandlers();\n            this.$el.hide();\n            if (this.options.id) {\n                this.id = this.options.id;\n            } else {\n                this.id = '';\n            }\n            this.show();\n        },\n\n        maximize : function() {\n            this.$el.removeClass('minimized');\n            this.$el.addClass('maximized');\n            this.state = \"maximized\";\n            var bottomOffset = 0;\n            if (this.options.window_manager) {\n                bottomOffset = this.options.window_manager.getContainer().height();\n            }\n            this.$el.css({\n                top: parseInt($('body').css('padding-top'), 10),\n                left: 0,\n                right: 0,\n                bottom: bottomOffset,\n                maxWidth: 'none',\n                width: 'auto',\n                height: 'auto'\n            });\n            this.$el.trigger(namespace + '.maximize');\n        },\n\n\n        restore : function() {\n            this.$el.removeClass('minimized');\n            this.$el.removeClass('maximized');\n            this.$el.removeAttr('style');\n            this.state = undefined;\n            this.$el.css({\n                top: this.window_info.top,\n                left: this.window_info.left,\n                width: this.window_info.width,\n                height: this.window_info.height\n            });\n            this.$el.removeProp('style');\n            this.$el.trigger(namespace + '.restore');\n        },\n\n        show : function(cb) {\n            var _this = this;\n            this.$el.css('visibility', 'visible');\n            var callbackHandler = function() {\n                _this.$el.trigger(namespace + '.show');\n                if (cb) {\n                    cb.call(_this, arguments);\n                }\n            };\n            if (this.options.effect === 'fade') {\n                this.$el.fadeIn(undefined, undefined, callbackHandler);\n            } else {\n                callbackHandler.call(this.$el);\n            }\n        },\n\n        setEffect : function(effect) {\n            this.options.effect = effect;\n        },\n\n        getEffect : function() {\n            return this.options.effect;\n        },\n\n        centerWindow : function() {\n            var top, left,\n                bodyTop = parseInt(this.options.references.body.position().top, 10) + parseInt(this.options.references.body.css('paddingTop'), 10),\n                maxHeight;\n            if (!this.options.sticky) {\n                left = (this.options.references.window.width() / 2) - (this.$el.width() / 2);\n                top = (this.options.references.window.height() / 2) - (this.$el.height() / 2);\n            } else {\n                left = (this.options.references.window.width() / 2) - (this.$el.width() / 2);\n                top = (this.options.references.window.height() / 2) - (this.$el.height() / 2);\n            }\n\n            if (top < bodyTop) {\n                top = bodyTop;\n            }\n            maxHeight = ((this.options.references.window.height() - bodyTop) - (parseInt(this.options.elements.handle.css('height'), 10) + parseInt(this.options.elements.footer.css('height'), 10))) - 45;\n            this.options.elements.body.css('maxHeight', maxHeight);\n\n            this.$el.css('left', left);\n            this.$el.css('top', top);\n            if (this.$el && this.$el.length > 0) {\n                this.window_info = {\n                    top: this.$el.position().top,\n                    left: this.$el.position().left,\n                    width: this.$el.outerWidth(),\n                    height: this.$el.outerHeight()\n                };\n            }\n            this.$el.trigger(namespace + '.centerWindow');\n        },\n\n        close : function(cb) {\n            var _this = this;\n            if (this.options.parent) {\n                this.options.parent.clearBlocker();\n                if (this.options.window_manager) {\n                    this.options.window_manager.setFocused(this.options.parent);\n                }\n            } else if (this.options.window_manager && this.options.window_manager.windows.length > 0) {\n                this.options.window_manager.setNextFocused();\n            }\n\n            var closeFn = function() {\n                _this.$el.trigger(namespace + '.close');\n                _this.$el.remove();\n                if (cb) {\n                    cb.call(_this);\n                }\n            };\n\n            if (this.options.effect === 'fade') {\n                this.$el.fadeOut(closeFn);\n            } else {\n                closeFn.call(_this.$el);\n            }\n\n            if (this.$windowTab) {\n                if (this.options.effect === 'fade') {\n                    this.$windowTab.fadeOut(400, function() {\n                        _this.$windowTab.remove();\n                    });\n                } else {\n                    this.$windowTab.hide();\n                    this.$windowTab.remove();\n                }\n\n            }\n        },\n\n        on : function() {\n            this.$el.on.apply(this.$el, arguments);\n        },\n\n        sendToBack : function () {\n            var returnVal = false;\n            if (this.options.window_manager) {\n                returnVal = this.options.window_manager.sendToBack(this);\n            }\n            return returnVal;\n        },\n\n        setActive : function(active) {\n            if (active) {\n                this.$el.addClass('active');\n                if (this.$windowTab) {\n                    this.$windowTab.addClass('label-primary');\n                }\n                this.$el.trigger('active');\n            } else {\n                this.$el.removeClass('active');\n                if (this.$windowTab) {\n                    this.$windowTab.removeClass('label-primary');\n                    this.$windowTab.addClass('label-default');\n                }\n                this.$el.trigger('inactive');\n            }\n        },\n\n        setIndex : function(index) {\n            this.$el.css('zIndex', index);\n        },\n\n        setWindowTab : function(windowTab) {\n            this.$windowTab = windowTab;\n        },\n\n        getWindowTab : function() {\n            return this.$windowTab;\n        },\n\n        getTitle : function() {\n            return this.options.title;\n        },\n\n        getElement : function() {\n            return this.$el;\n        },\n\n        setSticky : function(sticky) {\n            this.options.sticky = sticky;\n            if (sticky === false) {\n                this.$el.css({\n                    'position': 'absolute'\n                });\n            } else {\n                this.$el.css({\n                    'position': 'fixed'\n                });\n            }\n        },\n\n        getSticky : function() {\n            return this.options.sticky;\n        },\n\n        setManager : function(window_manager) {\n            this.options.window_manager = window_manager;\n        },\n\n        initHandlers : function() {\n            var _this = this;\n            var title_buttons;\n\n            this.$el.find('[data-dismiss=window]').on('click', function(event) {\n                event.stopPropagation();\n                event.preventDefault();\n                if (_this.options.blocker) {\n                    return;\n                }\n                _this.close();\n            });\n\n            this.$el.find('[data-maximize=window]').on('click', function(event) {\n                event.stopPropagation();\n                event.preventDefault();\n                if (_this.options.blocker) {\n                    return;\n                }\n                _this.maximize();\n            });\n\n            this.$el.find('[data-restore=window]').on('click', function(event) {\n                if (_this.options.blocker) {\n                    return;\n                }\n                _this.restore();\n            });\n\n            this.moveable = mover.movable(this.$el[0],{\n                handle : this.options.elements.title[0]\n            });\n\n            /*\n\n \n            this.$el.off('mousedown');\n            this.$el.on('mousedown', function() {\n                if (_this.options.blocker) {\n                    _this.options.blocker.getElement().trigger('focused');\n                    _this.options.blocker.blink();\n                    return;\n                } else {\n                    _this.$el.trigger('focused');\n                }\n\n                if (_this.$el.hasClass('ns-resize') || _this.$el.hasClass('ew-resize')) {\n                    $('body > *').addClass('disable-select');\n                    _this.resizing = true;\n                    _this.offset = {};\n                    _this.offset.x = event.pageX;\n                    _this.offset.y = event.pageY;\n                    _this.window_info = {\n                        top: _this.$el.position().top,\n                        left: _this.$el.position().left,\n                        width: _this.$el.outerWidth(),\n                        height: _this.$el.outerHeight()\n                    };\n\n                    if (event.offsetY < 5) {\n                        _this.$el.addClass('north');\n                    }\n                    if (event.offsetY > (_this.$el.height() - 5)) {\n                        _this.$el.addClass('south');\n                    }\n                    if (event.offsetX < 5) {\n                        _this.$el.addClass('west');\n                    }\n                    if (event.offsetX > (_this.$el.width() - 5)) {\n                        _this.$el.addClass('east');\n                    }\n                }\n            });\n\n\n            _this.options.references.body.on('mouseup', function() {\n                _this.resizing = false;\n                $('body > *').removeClass('disable-select');\n                _this.$el.removeClass('west');\n                _this.$el.removeClass('east');\n                _this.$el.removeClass('north');\n                _this.$el.removeClass('south');\n\n            });\n            _this.options.elements.handle.off('mousedown');\n            _this.options.elements.handle.on('mousedown', function(event) {\n                if (_this.options.blocker) {\n                    return;\n                }\n                _this.moving = true;\n                _this.offset = {};\n                _this.offset.x = event.pageX - _this.$el.position().left;\n                _this.offset.y = event.pageY - _this.$el.position().top;\n                $('body > *').addClass('disable-select');\n            });\n            _this.options.elements.handle.on('mouseup', function(event) {\n                _this.moving = false;\n                $('body > *').removeClass('disable-select');\n            });\n\n\n            _this.options.references.body.on('mousemove', _this.$el, function(event) {\n                if (_this.moving && _this.state !== \"maximized\" &&\n                    (\n                        $(event.toElement).hasClass(_this.options.selectors.handle.replace('.', '')) ||\n                        $(event.toElement).hasClass(_this.options.selectors.title.replace('.', ''))\n                    )) {\n\n\n                    var top = _this.options.elements.handle.position().top,\n                        left = _this.options.elements.handle.position().left;\n                    _this.$el.css('top', event.pageY - _this.offset.y);\n                    _this.window_info.top = event.pageY - _this.offset.y;\n                    _this.$el.css('left', event.pageX - _this.offset.x);\n                    _this.window_info.left = event.pageX - _this.offset.x;\n                    _this.window_info.width = _this.$el.outerWidth();\n                    _this.window_info.height = _this.$el.outerHeight();\n                }\n                if (_this.options.resizable && _this.resizing) {\n                    if (_this.$el.hasClass(\"east\")) {\n                        _this.$el.css('width', event.pageX - _this.window_info.left);\n                    }\n                    if (_this.$el.hasClass(\"west\")) {\n\n                        _this.$el.css('left', event.pageX);\n                        _this.$el.css('width', _this.window_info.width + (_this.window_info.left - event.pageX));\n                    }\n                    if (_this.$el.hasClass(\"south\")) {\n                        _this.$el.css('height', event.pageY - _this.window_info.top);\n                    }\n                    if (_this.$el.hasClass(\"north\")) {\n                        _this.$el.css('top', event.pageY);\n                        _this.$el.css('height', _this.window_info.height + (_this.window_info.top - event.pageY));\n                    }\n                }\n            });\n\n            this.$el.on('mousemove', function(event) {\n                if (_this.options.blocker) {\n                    return;\n                }\n                if (_this.options.resizable) {\n                    if (event.offsetY > (_this.$el.height() - 5) || event.offsetY < 5) {\n                        _this.$el.addClass('ns-resize');\n                    } else {\n                        _this.$el.removeClass('ns-resize');\n                    }\n                    if (event.offsetX > (_this.$el.width() - 5) || event.offsetX < 5) {\n                        _this.$el.addClass('ew-resize');\n\n                    } else {\n                        _this.$el.removeClass('ew-resize');\n                    }\n                }\n\n            });\n            */\n        },\n\n        resize : function(options) {\n            options = options || {};\n            if (options.top) {\n                this.$el.css('top', options.top);\n            }\n            if (options.left) {\n                this.$el.css('left', options.left);\n            }\n            if (options.height) {\n                this.$el.css('height', options.height);\n            }\n            if (options.width) {\n                this.$el.css('width', options.width);\n            }\n            this.$el.trigger(namespace + '.resize');\n        },\n\n        setBlocker : function(window_handle) {\n            this.options.blocker = window_handle;\n            this.$el.find('.disable-shade').remove();\n            var shade = '<div class=\"disable-shade\"></div>';\n            this.options.elements.body.append(shade);\n            this.options.elements.body.addClass('disable-scroll');\n            this.options.elements.footer.append(shade);\n            if (this.options.effect === 'fade') {\n                this.$el.find('.disable-shade').fadeIn();\n            } else {\n                this.$el.find('.disable-shade').show();\n            }\n\n            if (!this.options.blocker.getParent()) {\n                this.options.blocker.setParent(this);\n            }\n        },\n\n\n        getBlocker : function() {\n            return this.options.blocker;\n        },\n\n        clearBlocker : function() {\n            this.options.elements.body.removeClass('disable-scroll');\n            if (this.options.effect === 'fade') {\n                this.$el.find('.disable-shade').fadeOut(function() {\n                    this.remove();\n                });\n            } else {\n                this.$el.find('.disable-shade').hide();\n                this.remove();\n            }\n\n            delete this.options.blocker;\n        },\n\n        setParent : function(window_handle) {\n            this.options.parent = window_handle;\n            if (!this.options.parent.getBlocker()) {\n                this.options.parent.setBlocker(this);\n            }\n        },\n\n        getParent : function() {\n            return this.options.parent;\n        },\n\n        blink : function() {\n            var _this = this,\n                active = this.$el.hasClass('active'),\n\n                windowTab = this.getWindowTab(),\n                focused = windowTab ? windowTab.hasClass('label-primary') : undefined,\n\n                blinkInterval = setInterval(function() {\n                    _this.$el.toggleClass('active');\n                    if (windowTab) {\n                        windowTab.toggleClass('label-primary');\n                    }\n\n                }, 250),\n                blinkTimeout = setTimeout(function() {\n                    clearInterval(blinkInterval);\n                    if (active) {\n                        _this.$el.addClass('active');\n                    }\n                    if (windowTab && focused) {\n                        windowTab.addClass('label-primary');\n                    }\n\n                }, 1000);\n        }\n\n    });\n\n\n    datax.window = function(elm,options) {\n      var wgt  = this.data(elm,'sbswt.window');\n\n      if (!wgt) {\n        this.data(elm,'sbswt.window', (wgt = new Window(elm)));\n      }\n      if (typeof option == 'string') {\n        wgt[options]();\n      } \n   };\n\n\n    $.fn.window = function(options) {\n        return this.each(function() {\n            datax.window(this,options);          \n        });\n    };\n\n    velm.partial(\"window\",function(options){\n        datax.window(this.domNode,options);\n    });\n\n    $('[data-window-target]').off('click');\n    $('[data-window-target]').on('click', function() {\n        var $this = $(this),\n            opts = {\n                selectors: {}\n            };\n        if ($this.data('windowTitle')) {\n            opts.title = $this.data('windowTitle');\n        }\n\n        if ($this.data('titleHandle')) {\n            opts.selectors.title = $this.data('titleHandle');\n        }\n\n        if ($this.data('windowHandle')) {\n            opts.selectors.handle = $this.data('windowHandle');\n        }\n        if ($this.data('clone')) {\n            opts.clone = $this.data('windowHandle');\n        }\n\n        $($this.data('windowTarget')).window(opts);\n    });\n\n\n    var WindowManager = sbswt.WindowManager = sbswt.WidgetBase.inherit({\n        klassName: \"WindowManager\",\n\n        init : function(options) {\n            this.windows = [];\n            options = options || {};\n            this.initialize(options);\n            return this;\n        },\n\n        findWindowByID : function(id) {\n            var returnValue = null;\n            langx.each(this.windows, function(index, window) {\n                console.log(arguments);\n                if (window.id === id) {\n                    returnValue = window;\n                }\n            });\n            return returnValue;\n        },\n\n        destroyWindow : function(window_handle) {\n            var _this = this;\n            var returnVal = false;\n            langx.each(this.windows, function(index, window) {\n                if (window === window_handle) {\n                    window_handle.close();\n                    _this.windows.splice(index, 1);\n                    _this.resortWindows();\n                    returnVal = true;\n                }\n            });\n            return returnVal;\n        },\n\n        closeWindow : function(window_handle) {\n            this.destroyWindow(window_handle);\n        },\n\n        resortWindows : function() {\n            var startZIndex = 900;\n            langx.each(this.windows, function(index, window) {\n\n                window.setIndex(startZIndex + index);\n            });\n        },\n\n        setFocused : function(focused_window) {\n            var focusedWindowIndex;\n            while (focused_window.getBlocker()) {\n                focused_window = focused_window.getBlocker();\n            }\n            langx.each(this.windows, function(index, windowHandle) {\n                windowHandle.setActive(false);\n                if (windowHandle === focused_window) {\n                    focusedWindowIndex = index;\n                }\n            });\n            this.windows.push(this.windows.splice(focusedWindowIndex, 1)[0]);\n            focused_window.setActive(true);\n            this.resortWindows();\n\n        },\n\n        sendToBack : function(window) {\n            var windowHandle = this.windows.splice(this.windows.indexOf(window), 1)[0];\n            this.windows.unshift(windowHandle);\n            this.resortWindows();\n            return true;\n        },\n\n\n        initialize : function(options) {\n            this.options = options;\n            this.elements = {};\n\n            if (this.options.container) {\n                this.elements.container = $(this.options.container);\n                this.elements.container.addClass('window-pane');\n            }\n        },\n\n        getContainer : function() {\n            var returnVal;\n            if (this.elements && this.elements.container) {\n                returnVal = this.elements.container;\n            }\n            return returnVal;\n        },\n\n        setNextFocused : function() {\n            this.setFocused(this.windows[this.windows.length - 1]);\n        },\n\n        addWindow : function(window_object) {\n            var _this = this;\n            window_object.getElement().on('focused', function(event) {\n                _this.setFocused(window_object);\n            });\n            window_object.getElement().on('close', function() {\n                _this.destroyWindow(window_object);\n                if (window_object.getWindowTab()) {\n                    window_object.getWindowTab().remove();\n                }\n\n            });\n\n            window_object.on('bsw.restore', function() {\n                _this.resortWindows();\n            });\n\n            if (this.options.container) {\n                window_object.setWindowTab($('<span class=\"label label-default\">' + window_object.getTitle() + '<button class=\"close\">x</button></span>'));\n                window_object.getWindowTab().find('.close').on('click', function(event) {\n                    var blocker = window_object.getBlocker();\n                    if (!blocker) {\n                        window_object.close();\n                    } else {\n                        blocker.blink();\n                    }\n\n                });\n                window_object.getWindowTab().on('click', function(event) {\n                    var blocker = window_object.getBlocker();\n                    if (!blocker) {\n                        _this.setFocused(window_object);\n                        if (window_object.getSticky()) {\n                            window.scrollTo(0, window_object.getElement().position().top);\n                        }\n                    } else {\n                        blocker.blink();\n                    }\n                });\n\n                $(this.options.container).append(window_object.getWindowTab());\n            }\n\n            this.windows.push(window_object);\n            window_object.setManager(this);\n            this.setFocused(window_object);\n            return window_object;\n        },\n\n        createWindow : function(window_options) {\n            var _this = this;\n            var final_options = langx.mixin({},window_options);\n            if (this.options.windowTemplate && !final_options.template) {\n                final_options.template = this.options.windowTemplate;\n            }\n\n            var newWindow = new Window(final_options.template,final_options);\n\n\n            return this.addWindow(newWindow);\n        }\n\n    });\n\n\n/*----------------------------------------------------------------------*/\n    langx.mixin(sbswt,{\n        Window : Window,\n        WindowManager : WindowManager\n    });\n\n    return $.fn.window;\n});"]}